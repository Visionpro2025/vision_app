import streamlit as st
import os
import pandas as pd

LIB_PATH = "__LIBRARY"

def show_library():
    st.title("üìö Biblioteca de referencia")

    if not os.path.exists(LIB_PATH):
        st.error(f"No existe la carpeta {LIB_PATH}. Crea la carpeta en tu repo.")
        return

    files = os.listdir(LIB_PATH)
    if not files:
        st.warning("La biblioteca est√° vac√≠a. Agrega archivos en la carpeta __LIBRARY.")
        return

    st.write(f"üìÇ Total archivos: **{len(files)}**")

    # Selector para abrir archivo
    file_selected = st.selectbox("Selecciona un archivo:", files)

    if file_selected:
        file_path = os.path.join(LIB_PATH, file_selected)

        st.subheader(f"üìñ {file_selected}")

        # Mostrar seg√∫n el tipo de archivo
        if file_selected.endswith(".txt") or file_selected.endswith(".md"):
            with open(file_path, "r", encoding="utf-8") as f:
                st.text(f.read())

        elif file_selected.endswith(".csv"):
            df = pd.read_csv(file_path)
            st.dataframe(df)

        elif file_selected.endswith((".png", ".jpg", ".jpeg")):
            st.image(file_path, use_column_width=True)

        else:
            st.info("‚ö†Ô∏è Formato no soportado todav√≠a. Sube .txt, .md, .csv o im√°genes.")
